<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 at 25-November-2016 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20161125" />
    <meta http-equiv="Content-Language" content="en" />
    <title>BRMO 1.4.1-SNAPSHOT &#x2013; Developer notes</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

          
                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://www.b3partners.nl/" id="bannerLeft">
                                                                                                <img src="images/logo.png"  alt="B3Partners B.V."/>
                </a>
                      </div>
        <div class="pull-right">                                <a href="./" id="bannerRight">
                <h2>BRMO</h2>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="publishDate">Last Published: 25-November-2016
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 1.4.1-SNAPSHOT
                      </li>
                      
              
      
                                    
    <li class="pull-right">
                      <a href="issues" title="Issues dashboard">
        Issues dashboard</a>
      </li>

                    </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Information</li>
                              
      <li>
  
                          <a href="index.html" title="Home">
          <span class="none"></span>
        Home</a>
            </li>
                
      <li>
  
                          <a href="releasenotes.html" title="Release notes">
          <span class="none"></span>
        Release notes</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>Developer Notes</a>
          </li>
                              <li class="nav-header">Modules</li>
                              
      <li>
  
                          <a href="brmo-persistence/index.html" title="brmo-persistence">
          <span class="none"></span>
        brmo-persistence</a>
            </li>
                
      <li>
  
                          <a href="brmo-loader/index.html" title="brmo-loader">
          <span class="none"></span>
        brmo-loader</a>
            </li>
                
      <li>
  
                          <a href="bgt-gml-loader/index.html" title="brmo BGT-GML loader">
          <span class="none"></span>
        brmo BGT-GML loader</a>
            </li>
                
      <li>
  
                          <a href="brmo-taglib/index.html" title="brmo taglibrary">
          <span class="none"></span>
        brmo taglibrary</a>
            </li>
                
      <li>
  
                          <a href="brmo-service/index.html" title="brmo-service">
          <span class="none"></span>
        brmo-service</a>
            </li>
                
      <li>
  
                          <a href="brmo-proxyservice/index.html" title="brmo-proxyservice">
          <span class="none"></span>
        brmo-proxyservice</a>
            </li>
                
      <li>
  
                          <a href="brmo-soap/index.html" title="brmo-soap">
          <span class="none"></span>
        brmo-soap</a>
            </li>
                
      <li>
  
                          <a href="brmo-dist/index.html" title="BRMO distributie">
          <span class="none"></span>
        BRMO distributie</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                              
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                                                                                          
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Developer notes</h1>
<div class="section">
<h2><a name="release_maken"></a>release maken</h2>
<p>Een release bouwen begint met het uitvoeren van het commando <tt>mvn clean release:prepare</tt> daarbij wordt voor de verschillende artifacten om versienummers gevraagd (evt. de optie <tt>-DautoVersionSubmodules=true</tt> gebruiken als alles dezelfde versie moet krijgen), zowel voor voor de release als de volgende ontwikkel versie. Tevens wordt er om een naam voor een tag gevraagd. In principe kan alle informatie op de commandline worden meegegeven, bijvoorbeeld:</p>

<div class="source">
<div class="source"><pre class="prettyprint">mvn release:prepare -l rel-prepare.log -DautoVersionSubmodules=true -DdevelopmentVersion=1.4.1-SNAPSHOT -DreleaseVersion=1.4.0 -Dtag=v1.4.0 -T1
mvn release:perform -l rel-perform.log
</pre></div></div>
<p>Met het commando <tt>mvn release:perform</tt> wordt daarna, op basis van de tag uit de stap hierboven, de release gebouwd en gedeployed naar de repository uit de (parent) pom file. De release bestaat uit jar en war files met daarin oa. ook de javadoc en mogelijke site. Voor het hele project kan dit even duren, oa. omdat de javadoc ook gebouwd wordt.</p>
<div class="section">
<h3><a name="git_configuratie"></a>git configuratie</h3>

<div class="source">
<div class="source"><pre class="prettyprint">git config --add status.displayCommentPrefix true
export LANG=C
mvn clean release:prepare
</pre></div></div></div></div>
<div class="section">
<h2><a name="Integratie_en_unit_tests"></a>Integratie en unit tests</h2>
<p>Er zijn drie Maven profielen (postgresql, oracle, mssql) voor de ondersteunde databases gedefinieerd, de profiele zorgen ervoor dat de juist JDBC driver beschikbaar komt in de test suites, tevens kan daarmee de juiste configuratie worden geladen.</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th>unit tests </th>
      
<th>integratie tests </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td>Naamgeving conventie <tt>&lt;Mijn&gt;Test.java</tt> </td>
      
<td>Naamgeving conventie <tt>&lt;Mijn&gt;IntegrationTest.java</tt> </td>
    </tr>
    
<tr class="a">
      
<td>Zelfstandige tests, zonder runtime omgeving benodigdheden, eventueel voorzien van een data bestand, maar zonder verdere afhankelijkheden. </td>
      
<td>Tests die een database omgeving en/of servlet container nodig hebben. </td>
    </tr>
    
<tr class="b">
      
<td>Unit tests worden onafhankelijk van het gebruikte Maven profiel uitgevoerd, in principe tijdens iedere full build, tenzij er een <tt>skip</tt> optie voor het overslaan van de tests wordt meegegeven. </td>
      
<td>Unit tests worden afhankelijk van het gebruikte Maven profiel uitgevoerd. </td>
    </tr>
  </tbody>
</table>
<p>Bekijk de <tt>.travis.yml</tt> en <tt>appveyor.yml</tt> hoe de integratie tests worden gestart.</p>
<div class="section">
<h3><a name="database_configuratie"></a>database configuratie</h3>
<p>Voor de verschillende database omgevingen zijn er in bijvoorbeeld de <tt>brmo-service</tt> module, de <tt>brmo-loader</tt> module en de <tt>bgt-gml-loader</tt> module property files gemaakt met een configuratie die gebruikt wordt in de verschillende CI omgevingen. Deze bestanden zijn in de test resources te vinden. Lokaal kun je een override definieren voor een bepaalde omgeving door een bestand naast het bestaande te zetten met de naam <tt>local.&lt;DB smaakje&gt;.properties</tt>.</p>
<p>De te gebruiken database smaak wordt middels de <tt>database.properties.file</tt> property in de pom.xml van de module of via commandline ingesteld.</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th>property file </th>
      
<th>gebruikt op </th>
      
<th>override </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td>postgres.properties </td>
      
<td>Travis-CI </td>
      
<td>local.postgres.properties </td>
    </tr>
    
<tr class="a">
      
<td>sqlserver.properties </td>
      
<td>AppVeyor </td>
      
<td>local.sqlserver.properties </td>
    </tr>
    
<tr class="b">
      
<td>oracle.properties </td>
      
<td><b>TODO</b> </td>
      
<td>local.oracle.properties </td>
    </tr>
  </tbody>
</table>
<p>Voor gebruik van de propertyfile in een integratie test kun je overerven van een abstracte klasse in verschillende modules.</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th>module </th>
      
<th>klasse </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td>bgt-gml-loader </td>
      
<td><tt>nl.b3p.brmo.loader.gml.TestingBase</tt> </td>
    </tr>
    
<tr class="a">
      
<td>brmo-loader </td>
      
<td><tt>nl.b3p.AbstractDatabaseIntegrationTest</tt> </td>
    </tr>
    
<tr class="b">
      
<td>brmo-service </td>
      
<td><tt>nl.b3p.web.TestUtil</tt> </td>
    </tr>
  </tbody>
</table></div>
<div class="section">
<h3><a name="servlet_container_configuratie"></a>servlet container configuratie</h3>
<p>Voor de brmo-service module is een voorbeeld beschikbaar in de klasse <tt>nl.b3p.web.IndexPageIntegrationTest</tt></p></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                    2014&#x2013;2016
                        <a href="http://www.b3partners.nl/">B3Partners B.V.</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
